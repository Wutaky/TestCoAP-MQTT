{% extends "layout.html" %}
{% block script %}
<script type="text/javascript" charset="utf-8">
	$(document).ready(function(){
		var socket = io.connect('http://' + document.domain + ':' + location.port + '/socket_test');
		socket.on('mqtt_echo', function(msg) {
			var message = msg.payload.replace('\n', '<br>');
            $('#output_1').html(message);
        });
        socket.on('coap_echo', function(msg) {
			var message = msg.payload.replace('\n', '<br>');
            $('#output_2').html(message);
        });
	});
</script>
{% endblock %}

{% block content %}
<div class="row">
	{% if not result.empty_1 %}
		<h3>Resource #1</h3>
		<div class="col-md-3">
			<h4>Protocol:</h4>
			<p>MQTT</p>
		</div>
		<div class="col-md-3">
			<h4>Host:</h4>
			<p>{{ result.host_1 }}</p>
		</div>
		<div class="col-md-3">
			<h4>Port:</h4>
			<p>{{ result.port_1 }}</p>
		</div>
		<div class="col-md-3">
			<h4>Topic:</h4>
			<p>{{ result.topic_1 }}</p>
		</div>
		<div class="col-md-12">
			<h4>Message:</h4>
			<p><div id="output_1"></div></p>
			<div class="border-row" style="margin-bottom: 50px;"></div>
		</div>
	{% endif %}
	
	{% if not result.empty_2 %}		
		<h3>Resource #2</h3>
		<div class="col-md-3">
			<h4>Protocol:</h4>
			<p>CoAP</p>
		</div>
		<div class="col-md-3">
			<h4>Host:</h4>
			<p>{{ result.host_2 }}</p>
		</div>
		<div class="col-md-3">
			<h4>Port:</h4>
			<p>{{ result.port_2 }}</p>
		</div>
		<div class="col-md-3">
			<h4>Topic:</h4>
			<p>{{ result.topic_2 }}</p>
		</div>
		<div class="col-md-12">
			<h4>Message:</h4>
			<p><div id="output_2"></div></p>
		</div>
	{% endif %}
</div>
<div class="row">
	<div class="border-row" style="margin-bottom: 30px;"></div>
	<div class="col-md-12">
		<div class="col-md-3 col-md-offset-3"></div>
		<div class="col-md-3 col-md-offset-3">
			<a href="{{ url_for('unsubscribe') }}"><button type="button" class="btn btn-danger">Unsubscribe All</button></a>
		</div>
	</div>
</div>
{% endblock %}